-- SoulMatch Migration
-- version: 19.0
-- Adds a table for dynamic onboarding images.

-- 1. Create the onboarding_images table
CREATE TABLE IF NOT EXISTS "public"."onboarding_images" (
    "id" bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "image_url" text NOT NULL,
    "created_at" timestamptz DEFAULT now() NOT NULL
);

-- 2. Seed the table with diverse, high-quality placeholder images
-- Using picsum.photos for random, appealing images reflecting community and activities.
TRUNCATE public.onboarding_images RESTART IDENTITY;
INSERT INTO public.onboarding_images (image_url) VALUES
('https://picsum.photos/id/1011/400/400'),
('https://picsum.photos/id/1025/400/400'),
('https://picsum.photos/id/10/400/400'),
('https://picsum.photos/id/1005/400/400'),
('https://picsum.photos/id/1012/400/400'),
('https://picsum.photos/id/1013/400/400'),
('https://picsum.photos/id/1014/400/400'),
('https://picsum.photos/id/1027/400/400'),
('https://picsum.photos/id/1028/400/400'),
('https://picsum.photos/id/1029/400/400'),
('https://picsum.photos/id/1031/400/400'),
('https://picsum.photos/id/1032/400/400'),
('https://picsum.photos/id/1033/400/400'),
('https://picsum.photos/id/1040/400/400'),
('https://picsum.photos/id/1043/400/400'),
('https://picsum.photos/id/1050/400/400'),
('https://picsum.photos/id/1054/400/400'),
('https://picsum.photos/id/106/400/400'),
('https://picsum.photos/id/1060/400/400'),
('https://picsum.photos/id/1062/400/400'),
('https://picsum.photos/id/1074/400/400'),
('https://picsum.photos/id/1080/400/400'),
('https://picsum.photos/id/20/400/400'),
('https://picsum.photos/id/21/400/400'),
('https://picsum.photos/id/22/400/400'),
('https://picsum.photos/id/23/400/400'),
('https://picsum.photos/id/24/400/400'),
('https://picsum.photos/id/25/400/400'),
('https://picsum.photos/id/26/400/400'),
('https://picsum.photos/id/27/400/400');

-- 3. Enable RLS and set policies
ALTER TABLE public.onboarding_images ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS "Allow public read access to onboarding images" ON public.onboarding_images;
CREATE POLICY "Allow public read access to onboarding images" ON public.onboarding_images FOR SELECT USING (true);

-- 4. Grants
GRANT SELECT ON public.onboarding_images TO authenticated, anon;
